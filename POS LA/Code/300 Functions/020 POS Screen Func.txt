


[Function:LA_POS_Creation]
	
	Variable	:	Name		:	String
	
	000			:	Set			:	Name		:	"POS SALES"
	010			:	Call		:	LA_POS_CreationSet	:	##Name

[Function:LA_POS_CreationSet]

	Parameter	:	Name		:	String
	
	IfEmpty		:	If			:	$$IsEmpty:##Name
	msgBox		:	Msg Box		:	"Error!!!"	:	"Voucher Type not found"
	qbox		:	Query Box	:	"Create Voucher"		:	Yes	:	No
	creVch		:	Do If		:	$$LastResult:	Create Collection		:	VoucherType
	ret			:	Return
	endIf		:	End If
	
	000			:	Set			:	SVVoucherType	:	##Name
	
	001			:	Set			:	SVViewName	:	if $$IsPurchase:##Name then $$SysName:AcctgVchView	else $$SysName:InvVchView	
	002			:	Set			:	InvoicingModeFlag	:	Yes

	010			:	Create Collection			:	LA_POS_CompanyVouchers

;;;;;;;;;;;;;;;;;;;;;;  Cash POS Function	;;;;;;;;;;;;;
	
[Function:LA_POSCashFunc]

	Parameter	:	VarInvAmount	:	Amount
	
	001	:	Set	:	LA_BillPaid	:	Yes
	100 : Walk Collection: LedgerEntries
	200 : 	Set Target  : LedgerEntries[$$LoopIndex].
	
	300 : 	If: $LedgerName = $POSCardLedgerClass:VoucherType:##SVVoucherType
	400	:		Set Value	:	Amount	:	""
	500	:	End If

	510	:	If:	$LedgerName = $POSBankLedgerClass:VoucherType:##SVVoucherType
	520	:		Set Value	:	Amount	:	""
	530	:	End If

	600 : 	If: $LedgerName = $POSCashLedgerClass:VoucherType:##SVVoucherType
	700 : 		Set Value   : Amount : $$AsAmount:##VarInvAmount
	1000	:	Set Value	:	POSCashReceived	:	$$AsAmount:##VarInvAmount
	800 : 	End If

	900 : End Walk

	1200	:	Trigger Key	:	Ctrl + A

;;;;;;;;;;;;;;;;;;;;;;  Hold POS Function	;;;;;;;;;;;;;


[Function:LA_POSHoldFunc]

	Parameter	:	VarInvAmount	:	Amount

	000	:	Set	:	LA_BillPaid	:	Yes	
	001	: Set Value	:	ISOPTIONAL	:	Yes

	100 : Walk Collection: LedgerEntries
	200 : 	Set Target  : LedgerEntries[$$LoopIndex].
	
	300 : 	If: $LedgerName = $POSCardLedgerClass:VoucherType:##SVVoucherType
	400	:		Set Value	:	Amount	:	""
	500	:	End If

	510	:	If:	$LedgerName = $POSBankLedgerClass:VoucherType:##SVVoucherType
	520	:		Set Value	:	Amount	:	""
	530	:	End If

	600 : 	If: $LedgerName = $POSCashLedgerClass:VoucherType:##SVVoucherType
	700 : 		Set Value   : Amount : $$AsAmount:##VarInvAmount
	800 : 	End If

	900 : End Walk

	1000	:	Set Value	:	POSCashReceived	:	$$AsAmount:##VarInvAmount
	1200	:	Trigger Key	:	Ctrl + A

;;;;;;;;;;;;;;;;;;;;;;  Benefit Pay POS Function	;;;;;;;;;;;;;

[Function:LA_POSBenefitFunc]

	Parameter	:	VarInvAmount	:	Amount

	001	:	Set	:	LA_BillPaid	:	Yes
	100 : Walk Collection: LedgerEntries
	200 : Set Target  : LedgerEntries[$$LoopIndex].
	
	300 : 	If: $LedgerName = $POSCardLedgerClass:VoucherType:##SVVoucherType
	400	:		Set Value	:	Amount	:	""
	500	:	End If

	510	:	If:	$LedgerName = $POSBankLedgerClass:VoucherType:##SVVoucherType
	520	:		Set Value	:	Amount	:	$$AsAmount:##VarInvAmount
	530	:	End If

	600 : If: $LedgerName = $POSCashLedgerClass:VoucherType:##SVVoucherType
	800 : Set Value   : Amount : ""
	900 : End If

	1000 : End Walk

	1100 : Trigger Key	:	Ctrl+A
	
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  Multiple Pay SettleMent ;;;;;;;;;;

[Function:LA_POSMultiPayFunc]
	
	Parameter	:	LA_POSMultiPayAmnt	:	Amount

	000	:	Set	:	LA_BillPaid	:	Yes	
	001	:	Alter	:	LA_POSMultiPayRep

	00002	:	If	:	##LA_MultiPayAccept
	100 : Walk Collection: LedgerEntries
	200 : Set Target  : LedgerEntries[$$LoopIndex].
	
	300 : 	If: $LedgerName = $POSCardLedgerClass:VoucherType:##SVVoucherType
	350	:		Set Value	:	LedgerName		:	if ##LA_POSMultiCardType = "Credit Card" then "Credit Card" else $POSCardLedgerClass:VoucherType:##SVVoucherType
	400	:		Set Value	:	Amount			:	$$AsAmount:##LA_POSMultiCardAmount
	450	:		Set Value	:	POSCardNumber	:	##LA_POSMultiCardNumber
	500	:	End If

	510	:	If:	$LedgerName = $POSBankLedgerClass:VoucherType:##SVVoucherType
	520	:		Set Value	:	Amount	:	##LA_POSMultiBenefitAmnt
	530	:	End If

	600 : If: $LedgerName = $POSCashLedgerClass:VoucherType:##SVVoucherType
	800 :	 Set Value   : Amount : ##LA_POSMultiCashAmnt
	850	:	Set Value	:	POSCashReceived	:	##CashTenderdAmountVar
	900 : End If

	1000 : End Walk

	1100 : Trigger Key	:	Ctrl+A
	100000	:	End If
	
[Report:LA_POSMultiPayRep]
	Form	:	LA_POSMultiPayRep
	Variable	:	LA_POSMultiCardAmount,LA_POSMultiBenefitAmnt,LA_POSMultiCashAmnt

	[Form:LA_POSMultiPayRep]

		Part	:	FormSubTitle,LA_POSMultiPayRep
		Width	:	150 MMS
		Local	:	Part	:	FormSubTitle	:	Local	:	Field	:	FormSubTitle	:	Set as	:	"Muliple Payemnt Method For the Amount : " + $$LocaleString:##LA_POSMultiPayAmnt
		Control	:	LA_MsgWrongMulitPayAmount	:	##LA_POSMultiPayAmnt != ##LA_POSMultiCardAmount+##LA_POSMultiBenefitAmnt+##LA_POSMultiCashAmnt
		On	:	Form Accept	:	Yes	:	Set	:	LA_MultiPayAccept	:	yes

		[Part:LA_POSMultiPayRep]

			Part	:	LA_POSMultiCreditOrDebit,LA_POSMultiCashBenefit
			Vertical	:	Yes
			Border	:	thin Box
			
;;;;;;;;;Credit Card Or Debit Card
			[Part:LA_POSMultiCreditOrDebit]
				Line	:	LA_POSMultiCardTypeTitle,LA_POSMultiCardType,+
							LA_POSMultiCardAmount,LA_POSMultiCardNumber
				[Line:LA_POSMultiCardTypeTitle]
					Field	:	FormSubTitle
					Local	:	Field	:	FormSubTitle	:	Set as	:	"Credit Card/Debit Card"
						
				[Line:LA_POSMultiCardType]
					Field	:	Medium Prompt,LA_POSMultiCardType
					Local	:	Field	:	Medium Prompt	:	Set as	:	"Card Type"
					[Field:LA_POSMultiCardType]
						Use	:	Name Field
						Set Always	:	Yes
						Table	:	LA_POSMultiCardTypeCll
						Show Table	:	Always
						Modifies	:	LA_POSMultiCardType	:	Yes
						Border	:	thin Box
						[Collection:LA_POSMultiCardTypeCll]

							Title	:	"Type of Card"
							List	:	"Credit Card","Debit Card"
							
				[Line:LA_POSMultiCardAmount]
					Field	:	Medium Prompt,LA_POSMultiCardAmount
					Local	:	Field	:	Medium Prompt	:	Set as	:	"Amount"
					[Field:LA_POSMultiCardAmount]
						Use	:	Amount Field
						Set Always	:	Yes
						Modifies	:	LA_POSMultiCardAmount	:	Yes
						Border	:	thin Box
				[Line:LA_POSMultiCardNumber]
					Field	:	Medium Prompt,LA_POSMultiCardNumber
					Local	:	Field	:	Medium Prompt	:	Set as	:	"Card Number"
					[Field:LA_POSMultiCardNumber]
						Use	:	Name Field
						Set Always	:	Yes
						Modifies	:	LA_POSMultiCardNumber	:	Yes
						Border	:	thin Box
;;;;;;;;;Credit Card Or Debit Card End

			;;;;;;;;;;;;;  Cash Benefit
			[Part:LA_POSMultiCashBenefit]

				Part	:	LA_POSMultiBenefit,LA_POSMultiCash
				Vertical	:	No
				Border	:	Thin Top

				[Part:LA_POSMultiBenefit]
					Line	:	LA_POSMultiBenefitTit,LA_POSMultiBenefit
					[Line:LA_POSMultiBenefitTit]
						Field	:	FormSubTitle
						Local	:	Field	:	FormSubTitle	:	Set as	:	"Benefit Pay"

					[Line:LA_POSMultiBenefit]
						Field	:	Medium Prompt,LA_POSMultiBenefit
						Local	:	Field	:	Medium Prompt	:	Set as	:	"Amount"
						[Field:LA_POSMultiBenefit]
							Use	:	Amount Field
							Set Always	:	Yes
							Modifies	:	LA_POSMultiBenefitAmnt	:	Yes
							Border	:	thin Box
				[Part:LA_POSMultiCash]
					Line	:	LA_POSMultiCashTit,LA_POSMultiCashAmnt,+
								LA_POSMultiCashTend,LA_POSMultiCashBalance
					[Line:LA_POSMultiCashTit]
						Field	:	FormSubTitle
						Local	:	Field	:	FormSubTitle	:	Set as	:	"Cash"
					
					[Line:LA_POSMultiCashAmnt]
						Field	:	Medium Prompt,LA_POSMultiCashAmnt
						Local	:	Field	:	Medium Prompt	:	Set as	:	"Cash Amount"

						[Field:LA_POSMultiCashAmnt]
							
							Use	:	Amount Field
							Set Always	:	Yes
							Modifies	:	LA_POSMultiCashAmnt	:	Yes
							Border	:	thin Box
					[Line:LA_POSMultiCashTend]
						Field	:	Medium Prompt,LA_POSMultiCashTend
						Local	:	Field	:	Medium Prompt	:	Set as	:	"Cash Tendered"
						[Field:LA_POSMultiCashTend]
							Use	:	Amount Field
							Set Always	:	Yes
							Modifies	:	CashTenderdAmountVar	:	Yes
							Border	:	thin Box
					[Line:LA_POSMultiCashBalance]
						Field	:	Medium Prompt,LA_POSMultiCashBalance
						Local	:	Field	:	Medium Prompt	:	Set as	:	"Balance"
						[Field:LA_POSMultiCashBalance]
							Use	:	Amount Field
							Set Always	:	Yes
							Set as	:	##LA_POSMultiPayAmnt;if $$IsEmpty:#LA_POSMultiCashTend then "" else (##LA_POSMultiPayAmnt - (##LA_POSMultiCardAmount+##LA_POSMultiBenefitAmnt+##CashTenderdAmountVar));## ##LA_POSMultiPayAmnt != +##LA_POSMultiCashAmnt
							Border	:	thin Box
							
	;;;;;;;;;;;;;;;; Cash Benefit End
	

;;;;;;;;;;;;;;;;;  Update Disc Amount

[Function:UpdateLedEntriss]
	Parameter	:	LA_DiscountAmountPar	:	Amount
	Parameter	:	LA_POSRoundOffPar		:	Amount

	100 : Walk Collection: LedgerEntries
	200 : Set Target  : LedgerEntries[$$LoopIndex].
	
	300 : 	If: $LedgerName Contains "Discount" 
	400	:		Set Value	:	Amount			:	-##LA_DiscountAmountPar
	500	:	End If

	600 : 	If: $LedgerName Contains "RoundOff" 
	700	:		Set Value	:	Amount			:	##LA_POSRoundOffPar
	800	:	End If
	
	900	: End Walk

;;;;;;;;;;;;;;;;;  Set Cash amount and save	;;;;;;;;;;


[Function:LA_POSCashAcceptFunc]

	Parameter	:	VarInvAmount	:	Amount
	
	001	:	Set	:	LA_BillPaid	:	Yes
	100 : Walk Collection: LedgerEntries
	200 : 	Set Target  : LedgerEntries[$$LoopIndex].
	
	300 : 	If: $LedgerName = $POSCardLedgerClass:VoucherType:##SVVoucherType
	400	:		Set Value	:	Amount	:	""
	500	:	End If

	510	:	If:	$LedgerName = $POSBankLedgerClass:VoucherType:##SVVoucherType
	520	:		Set Value	:	Amount	:	""
	530	:	End If

	600 : 	If: $LedgerName = $POSCashLedgerClass:VoucherType:##SVVoucherType
	700 : 		Set Value   : Amount : $$AsAmount:##VarInvAmount
	1000	:	Set Value	:	POSCashReceived	:	$$AsAmount:##VarInvAmount
	800 : 	End If

	900 : End Walk



;;;;;;;;;;;;;;  Multi Cash Variables

[Variable:LA_POSMultiCashAmnt]
	Type	:	Amount
[Variable:CashTenderdAmountVar]
	Type	:	Amount

;;;;;;;;;;;  Multi Benefit pay Variables

[Variable:LA_POSMultiBenefitAmnt]
	
	Type	:	Amount

;;;;;;;;;;; Multi Card Pay Varibles
	
[Variable:LA_POSMultiCardType]
	Type	:	String

[Variable:LA_POSMultiCardAmount]
	
	Type	:	Amount
	
[Variable:LA_POSMultiCardNumber]
	
	Type	:	String

[Variable:LA_MultiPayAccept]
	
	Type	:	Logical
	
[Variable:LA_BillPaid]

	Type	:	Logical
	
[System:Variable]
		
	CashTenderdAmountVar	:	""
	LA_POSMultiCashAmnt		:	""
	
	LA_POSMultiBenefitAmnt		:	""

	LA_POSMultiCardType		:	""
	LA_POSMultiCardAmount	:	""
	LA_POSMultiCardNumber	:	""
	
	LA_MultiPayAccept		:	No
	
	LA_BillPaid				:	No