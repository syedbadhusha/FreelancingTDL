

[Report:SB_AM_QuotDetReport]
	Title	:	"Quotation Detailed"
	Form	:	SB_AM_QuotDetReport

	Variable	:	SvFromDate,SVToDate
	
	Variable	:	SB_AM_QuotCustVar
	Variable	:	SB_AM_QuotCustLog
	
	Variable	:	SB_AM_QuotItemVar
	Variable	:	SB_AM_QuotItemLog

	Variable	:	SB_AM_QuotProjVar
	Variable	:	SB_AM_QuotProjLog
	
	Variable	:	SB_AM_QuotStatusVar
	Variable	:	SB_AM_QuotStatusLog
	
	[Form:SB_AM_QuotDetReport]
		
		Set		:	SB_AM_QuotCustVar	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotCustVar else ""
		Set		:	SB_AM_QuotCustLog	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotCustLog else No

		Set		:	SB_AM_QuotItemVar	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotItemVar else ""
		Set		:	SB_AM_QuotItemLog	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotItemLog else ""

		Set		:	SB_AM_QuotProjVar	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotProjVar else ""
		Set		:	SB_AM_QuotProjLog	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotProjLog else ""

		Set		:	SB_AM_QuotStatusVar	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotStatusVar else ""
		Set		:	SB_AM_QuotStatusLog	:	if $$InPrintMode or $$InExportMode	then ##SB_AM_QuotStatusLog else ""


		Button		 : 	ChangePeriod,SB_AM_QuotCustFilter,SB_AM_QuotItemFilter,+
						SB_AM_QuotProjFilter,SB_AM_QuotStatusFilter

		Part         :  SB_AM_QuotApprovalTop,SB_AM_QuotDetReport

		Page Break   : 	EXPINV PageBreak,SB_AM_QuotApprovalTop
		
		Local	:	Part	:	SB_AM_QuotApprovalTop	:	Delete	:	Part	:	SB_AM_QuotApprovalTop2
		Local	:	Part	:	SB_AM_QuotApprovalTop	:	Local	:	Part	:	SB_AM_QuotApprovalTop1	:	Local	:	Line	:	SB_AM_CMPReporttit	:	Local	:	Field	:	Name Field	:	Set as	:	"Qutations Detial"
		Local	:	Part	:	SB_AM_QuotApprovalTop	:	Add	:	Part	:	after	:	SB_AM_QuotApprovalTop1	:	SB_AM_QuotDetailsTop2

		Local	:	Field	:	SB_AM_QuotAppCustName	:	Delete	:	Full Width
		Local	:	Field	:	SB_AM_QuotAppCustName	:	Width	:	50 MMS
				
		Local	:	Field	:	SB_AM_QuotItemQty			:	Width	:	25 MMS
		Local	:	Field	:	SB_AM_QuotItemRate			:	Width	:	25 MMS
		Local	:	Field	:	SB_AM_QuotAppAmount			:	Width	:	25 MMS
		
		[Part:SB_AM_QuotDetailsTop2]

			Line		:	SB_AM_QuotDetailsColTitle
			Background	:	Aquamarine
			Local		:	Field	:	Default	:	Color	:	white

			[Line:SB_AM_QuotDetailsColTitle]
				Field	:	SB_AM_QuotAppDate,SB_AM_QuotAppCustName,SB_AM_QuotAppNo,SB_AM_QuotItem
				Right Field	:	SB_AM_QuotProjName,SB_AM_QuotItemQty,SB_AM_QuotItemRate,SB_AM_QuotAppAmount,SB_AM_QuotAppStatus
				
				Border	:	Thin top bottom
				
				Local	:	Field	:	Default	:	Type	:	String
				Local	:	Field	:	Default	:	Style	:	Small Bold
					
				Local	:	Field	:	SB_AM_QuotAppDate			:	Set as	:	"Date"
				Local	:	Field	:	SB_AM_QuotAppCustName		:	Set as	:	"Customer Name"
				Local	:	Field	:	SB_AM_QuotAppNo				:	Set as	:	"Quotation No"
				Local	:	Field	:	SB_AM_QuotItem				:	Set as	:	"Item Description"
				Local	:	Field	:	SB_AM_QuotItemQty			:	Set as	:	"Quantity"
				Local	:	Field	:	SB_AM_QuotItemRate			:	Set as	:	"Rate"
				Local	:	Field	:	SB_AM_QuotAppAmount			:	Set as	:	"Amount"
				Local	:	Field	:	SB_AM_QuotAppStatus			:	Set as	:	"Status"
				Local	:	Field	:	SB_AM_QuotProjName			:	Set as	:	"Project Name"

				
		[Part:SB_AM_QuotDetReport]
			Line:SB_AM_QuotDetReport
			Repeat:SB_AM_QuotDetReport	:	SB_AM_QuotDetReportCll
			Scroll	:	Vertical
			Common Border	:	Yes
			
			[Line:SB_AM_QuotDetReport]
				Field	:	SB_AM_QuotAppDate,SB_AM_QuotAppCustName,SB_AM_QuotAppNo,SB_AM_QuotItem
				Right Field	:	SB_AM_QuotProjName,SB_AM_QuotItemQty,SB_AM_QuotItemRate,SB_AM_QuotAppAmount,SB_AM_QuotAppStatus
				Local	:	Field	:	SB_AM_QuotAppStatus	:	Set as	:	$SB_AM_QuotStatus1

				[Field:SB_AM_QuotItem]
					
					Use	:	Name Field
					Set Always	:	Yes
					Set as	:	$StockitemName
					Full Width	:	Yes
					Border	:	thin left
					Style	:	Normal

				[Field:SB_AM_QuotProjName]
					
					Use	:	Name FIeld
					Set Always	:	Yes
					Set as	:	$CostcentreName
					Width	:	40 MMS
					Border	:	thin left
					Style	:	Normal

				[Field:SB_AM_QuotItemQty]
					
					Use	:	Qty Field
					Set as	:	$BilledQty
					Set Always	:	Yes
					Width	:	30 MMS
					Border	:	thin left
					Style	:	Normal
					
				[Field:SB_AM_QuotItemRate]

					Use	:	Rate Field
					Set Always	:	Yes
					Set as	:	$Rate
					Width	:	30 MMS
					Border	:	thin left
					Style	:	Normal
					

[Collection:SB_AM_QuotDetReportCll]
	
	Source Collection	:	SB_AM_QuotDetReportCllSrc
	
	Walk	:	InventoryEntries
	By		:	CostcentreName		:	$CostcentreName
	By		:	StockItemName		:	$StockItemName
	By		:	PartyLedgerName		:	$PartyLedgerName
	By		:	SB_AM_QuotStatus1	:	$..SB_AM_QuotStatus

	Fetch	:	CostcentreName,StockItemName,VoucherNumber,+
				Date,PartyLedgerName,BilledQty,Rate,Amount,+
				SB_AM_QuotStatus,InventoryEntries.*
	
	Option	:	SB_AM_QuotDetCustCll		:	##SB_AM_QuotCustLog
	Option	:	SB_AM_QuotDetItemCll		:	##SB_AM_QuotItemLog
	Option	:	SB_AM_QuotDetProjCll		:	##SB_AM_QuotProjLog
	Option	:	SB_AM_QuotDetStatusCll			:	##SB_AM_QuotStatusLog
	
[Collection:SB_AM_QuotDetReportCllSrc]
	
	Type	:	Vouchers:VoucherType
	Child Of	:	$$VchTypeSalesOrder
	Belongs To	:	Yes
	Filter	:	SB_AM_VTYPQuotation_FRMLA
	
[!Collection:SB_AM_QuotDetCustCll]
	
	Filter	:	SB_AM_QuotCustFlter
	
[!Collection:SB_AM_QuotDetItemCll]
	
	Filter	:	SB_AM_QuotItemFltr

[!Collection:SB_AM_QuotDetProjCll]
	
	Filter	:	SB_AM_QuotProjFltr

[!Collection:SB_AM_QuotDetStatusCll]
	
	Filter	:	SB_AM_QuotStatusFltr

;;;;;;;;;;;;;;;;;;;;  Customer Filter	;;;;;;;;;;;

[Button:SB_AM_QuotCustFilter]
	
	Key	:	Alt + T
	Title	:	"Customer"
	Action	:	Execute	:	SB_AM_QuotCustFltrRp
	
[Report:SB_AM_QuotCustFltrRp]
	
	Variable	:	SB_AM_QuotCustLog
	Use     : Collection Variable
	Title	: $$LocaleString:"Select Customer"
	Local   : Line : Collection Variable : Field : SB_AM_QuotCustFld
	Local   : Field: MV Title            : Info  : $$LocaleString:"Customer Name"

		[Field:SB_AM_QuotCustFld]
			
			Use	:	Name Field
			Set Always	:	Yes
			Show Table	:	Always
			Table	:	SB_AM_QuotCustCll
			Modifies	:	SB_AM_QuotCustVar	:	Yes

			On	:	Accept	:	Yes	:	Set	:	SB_AM_QuotCustLog	:	Yes
			On	:	Accept	:	Yes	:	Field Accept

[Collection:SB_AM_QuotCustCll]

	Title	:	"List Of Customer"
	Type	:	Ledger
	Include	:	Group	:	$$GroupSundryDebtors
	Include	:	Group	:	$$GroupSundryCreditors
	
;;;;;;;;;;;;;;;;;;;;  StockItemName Filter	;;;;;;;;;;;

[Button:SB_AM_QuotItemFilter]
	
	Key	:	Alt + I
	Title	:	"Stockitem"
	Action	:	Execute	:	SB_AM_QuotItemFltrRp
	
[Report:SB_AM_QuotItemFltrRp]
	
	Variable	:	SB_AM_QuotItemLog
	Use     : Collection Variable
	Title	: $$LocaleString:"Select Stock Item"
	Local   : Line : Collection Variable : Field : SB_AM_QuotItemFld
	Local   : Field: MV Title            : Info  : $$LocaleString:"Name of Item"

		[Field:SB_AM_QuotItemFld]
			
			Use	:	Name Field
			Set Always	:	Yes
			Show Table	:	Always
			Table	:	SB_AM_QuotItemCll
			Modifies	:	SB_AM_QuotItemVar		:	Yes
			On	:	Accept	:	Yes	:	Set	:	SB_AM_QuotItemLog	:	Yes
			On	:	Accept	:	Yes	:	Field Accept

[Collection:SB_AM_QuotItemCll]

	Title	:	"List Of Stockitem"
	Type	:	StockItem

;;;;;;;;;;;;;;;;;;;;  Customer Filter	;;;;;;;;;;;
[Button:SB_AM_QuotProjFilter]
	
	Key	:	Alt + j
	Title	:	"Project"
	Action	:	Execute	:	SB_AM_QuotProjFltrRp
	
[Report:SB_AM_QuotProjFltrRp]
	
	Variable	:	SB_AM_QuotProjLog

	Use     : Collection Variable
	Title	: $$LocaleString:"Select Project"
	Local   : Line : Collection Variable : Field : SB_AM_QuotProjFld
	Local   : Field: MV Title            : Info  : $$LocaleString:"Project Name"

		[Field:SB_AM_QuotProjFld]
			
			Use	:	Name Field
			Set Always	:	Yes
			Show Table	:	Always
			Table	:	SB_AM_QuotProjCll
			Modifies	:	SB_AM_QuotProjVar	:	Yes
			On	:	Accept	:	Yes	:	Set	:	SB_AM_QuotProjLog	:	Yes
			On	:	Accept	:	Yes	:	Field Accept

[Collection:SB_AM_QuotProjCll]

	Title	:	"List Of Project"
	Type	:	CostCentre

;;;;;;;;;;;;;;;;;;;;  Status Filter	;;;;;;;;;;;

[Button:SB_AM_QuotStatusFilter]
	
	Key	:	Alt + U
	Title	:	"Status"
	Action	:	Execute	:	SB_AM_QuotStatusRp
	
[Report:SB_AM_QuotStatusRp]
	
	Variable	:	SB_AM_QuotStatusLog
	Use     : Collection Variable
	Title	: $$LocaleString:"Select Status"
	Local   : Line : Collection Variable : Field : SB_AM_QuotStatusFld
	Local   : Field: MV Title            : Info  : $$LocaleString:"Status"
	Local	:	Form	:	Default	:	Set	:	SB_AM_QuotCustLog	:	Yes

		[Field:SB_AM_QuotStatusFld]
			
			Use	:	Name Field
			Set Always	:	Yes
			Show Table	:	Always
			Table	:	SB_AM_QuotStatusCll
			Modifies	:	SB_AM_QuotStatusVar	:	Yes
			On	:	Accept	:	Yes	:	Set	:	SB_AM_QuotStatusLog	:	Yes
			On	:	Accept	:	Yes	:	Field Accept

[Collection:SB_AM_QuotStatusCll]

	Title	:	"List Of Status"
	List	:	"Approved","Pending","Declined"

;;;;;;;;;;;;;;  Filter System Formula	;;;;

[System:Formula]
	
	SB_AM_QuotCustFlter		:	$PartyLedgerName 	= 	##SB_AM_QuotCustVar
	SB_AM_QuotItemFltr		:	$StockItemName		=	##SB_AM_QuotItemVar
	SB_AM_QuotProjFltr		:	$CostCentreName		=	##SB_AM_QuotProjVar
	SB_AM_QuotStatusFltr	:	$SB_AM_QuotStatus1	=	##SB_AM_QuotStatusVar
	
;;;;;;;;;;;;;;;;;;;Variables ;;;

[System:Variable]
	
	SB_AM_QuotCustVar	:	""
	SB_AM_QuotCustLog	:	No
	
	SB_AM_QuotItemVar	:	""
	SB_AM_QuotItemLog	:	No
	
	SB_AM_QuotProjVar	:	""
	SB_AM_QuotProjLog	:	No

	SB_AM_QuotStatusVar	:	""
	SB_AM_QuotStatusLog	:	No

	
;;;;;;;
[Variable:SB_AM_QuotCustVar]
	
	Type	:	String
	
[Variable:SB_AM_QuotCustLog]
	
	Type	:	Logical
	
;;;;;

[Variable:SB_AM_QuotItemVar]
	
	Type	:	String
	
[Variable:SB_AM_QuotItemLog]
	
	Type	:	Logical
	
;;;;;;;;;

[Variable:SB_AM_QuotProjVar]
	
	Type	:	String
	
[Variable:SB_AM_QuotProjLog]
	
	Type	:	Logical

;;;;;;;;;;;
	
[Variable:SB_AM_QuotStatusVar]
	
	Type	:	String
	
[Variable:SB_AM_QuotStatusLog]
	
	Type	:	Logical
	
