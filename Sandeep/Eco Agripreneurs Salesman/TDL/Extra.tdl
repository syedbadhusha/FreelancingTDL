;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always

;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: UploadFileName4new1
;
;[Table		: File Name4new1]
;	
;	Data Source	: Directory: #UploadExPath4new1
;	Filter		: ExcelFileFormat4new1
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	ExcelFileFormat4new1	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: UploadFilePath4new1]
;	
;	Use			: Name Field 
;	Set as		: #UploadExPath4new1+ "\" +#UploadFileName4new1
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadFilePath4new1
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: CollectSheetNames4new1
;	
;
;[Function	: CollectSheetNames4new1]
;	
;	Variable	: NoSheets : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: SheetList4new1
;	10 : OPEN FILE  : #UploadFilePath4new1 : Excel : Read
;	20 : Set 		: NoSheets : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##NoSheets
; 	40 : List Add Ex: SheetList4new1
;	50 : Set		: SheetList4new1[##Counter].Sheetname4new1:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: SheetList4new1]
;		
;	Variable: Sheetname4new1 : String
;	
;[System	: Variables]
;	
;	List Var : SheetList4new1
;	
;[Collection	: Excel Sheet Coll4new1]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: SheetList4new1
;	Format		: $Sheetname4new1
;	
;
;
;
;[Field	: UploadSheetName4new1]
;	
;	Use			: Name Field 
;	Table		: Excel Sheet Coll4new1
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: UploadSheetName4new1
;
;
;[System:UDF]
;UploadSheetName4new1:String:3001
;UploadFilePath4new1:String:3002
;UploadFilePath4new1:String:3003
;UploadExPath4new1:String:3004
;BankName1receipt:String:8995
;ExcelVhcTypeInfo4:String:8908
;
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;
;
;
;
;[Function	: FnCustUdaan ExlSalesData14new1]
;	Variable		: 	VarSalesExlDirectory		: String
;	Variable		: 	SBExlRowCounter				: Number	: 2
;	Variable		: 	VarIndex					: Number	: 1
;	Variable		: 	VarCustLastSyncDt			: Date
;	Variable		: 	VarCustUploadExlFile		: String	: ""
;	Variable		: 	VarCustUploadExlFilePath		: String	: ""
;	Variable		: 	VarCustExlUploadStatus			: String	: ""
;	Variable		: 	VarCustUploadBatchNo				: String	: ""
;	Variable		: 	VarLastModifiedDate				: Date
;	Variable		: 	VarLastModifiedTime				: Time
;	Variable		: 	CustIndex										: Number
;	Variable		:	VarCustExlVchType	    : String
;	
;	
;	LB15:Log	: ">>>>> Importing Sales Excel Data"
;	
;	p20		: 		Open File	: #UploadExPath4new1+ "\" +#UploadFileName4new1	: 	Excel 	: 	Read
;	p30		: 	    Set Active Sheet	:#UploadSheetName4new1	
;	
;	B15	:	List Delete Ex	: CustGSTExl2TlySalesListVar5
;	
;	B25	:		WHILE					: (NOT $$IsEmpty:($$FileReadCell:##SBExlRowCounter:1)) 
;
;	
;	B32	:		LIST ADD EX	:  CustGSTExl2TlySalesListVar5
;
;	B34	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHdate			: $$FileReadCell:##SBExlRowCounter:1
;	B36	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHnumber						: $$FileReadCell:##SBExlRowCounter:2
;	B36aa	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHbilltype						: $$FileReadCell:##SBExlRowCounter:3
;	B38	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchno					: $$FileReadCell:##SBExlRowCounter:4; ##CustGSTSalesVchType			;	
;	;B42	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].refvchdate			    : 	$$FileReadCell:##SBExlRowCounter:4
;	B42z	: 	Set	: CustGSTExl2TlySalesListVar5[##VarIndex].VCHcostcentre	    : 	$$FileReadCell:##SBExlRowCounter:5
;																												  
;																													  
;	B52	: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].Vchledname			    : $$FileReadCell:##SBExlRowCounter:6
;	B52aa:        Set:CustGSTExl2TlySalesListVar5[##VarIndex].vchdebitamt:$$FileReadCell:##SBExlRowCounter:7
;	B52a: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchcreditamt		    : $$FileReadCell:##SBExlRowCounter:8
;	B52aba: 		  Set	: CustGSTExl2TlySalesListVar5[##VarIndex].vchnewnarration1		    : $$FileReadCell:##SBExlRowCounter:9
;	B86:		Increment	: SBExlRowCounter
;	B88: 		Increment	: VarIndex
;	B25z: 		End While
;	500 	:	Close File
;	C15	: Call		: JounralVoucherFun2
;	
;	
;[System:Variables]
;	List variable: CustGSTExl2TlySalesListVar5
;
;[Variable		: CustGSTExl2TlySalesListVar5]
;	Variable:vchdate:String
;	Variable:vchnumber:String
;	Variable:refvchno:String
;	Variable:refvchdate:String
;	Variable:vchcostcentre:String
;	Variable:vchledname:String
;	Variable:vchdebitamt:Number
;	Variable:vchcreditamt:Number
;	Variable:vchnewnarration1:String
;	Variable:vchbilltype:String
;	
;
;
;
;[Collection		: CustGSTExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;[Collection		: CustExl2TlySalesListCollSrc4]
;	Data Source	: Variable		: CustGSTExl2TlySalesListVar5
;	Fetch				: *.*
;	
;
;;select * from CustExl2TlySalesListCollSrc
;[Collection				: CustExl2TlyJournalListColl]	; Select $CustVchPartyAlias, $CustVchParty, $CustVchDate, $CustExlVchOrdNo from CustExl2TlySalesListColl
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate	: $vchdate
;	By:Vouchernumber:$vchnumber
;	Compute:Ledname:$vchledname
;	Aggr Compute:Dramount:Sum:$vchdebitamt
;	Aggr Compute:Cramount:Sum:$vchcreditamt
;	Compute:CCname:$VCHcostcentre
;	Compute:Narr:$vchnewnarration1
;
;	
;[Collection:CustExl2TlyJournalListColl2]
;	Source Collection	: CustGSTExl2TlySalesListCollSrc4
;    Compute	: VoucherDate1	: $vchdate
;	Compute:VCHNUM:$vchnumber
;	Compute:Ledname1:$vchledname
;	Compute:Dramount1:$vchdebitamt
;	Compute:Cramount1:$vchcreditamt
;	Compute:CCname1:$VCHcostcentre
;	Compute:ref:$refvchno
;	Compute:btype:$vchbilltype
;	Filter:vchfilter
;	
;[System:Formulae]
;	vchfilter:$VCHNUM=##vchnumbervar
;	
;
;
;
;	[Function:JounralVoucherFun2]
;
;    
;	Variable:vchnumbervar:String
;	Variable:cc:String
;	
;	
;       a1:Log:"Start"
;	
;      13:Walk Collection:CustExl2TlyJournalListColl
;	  jklo:Set:vchnumbervar:$Vouchernumber
;	  new56:Set:cc:$ccname
;	;  hjnew1:Log:$ccname
;    
;	  10005	: 	NEW OBJECT		:	Voucher
;	  10010 : 	SET VALUE		: 	Date				: 	$$Date:$VoucherDate
;	  xgasggag:Set Value:vouchernumber:##vchnumbervar
;	  
;
;	  10015	: 	SET VALUE		: 	VoucherTypeName		: 	##ExcelVhcTypeInfo4
;	  g1:Set Value:PARTYLEDGERNAME: $Ledname
;	  jkoiplbgw:Set Value:COSTCENTRENAME:##cc
;	  g2:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	  hslopiu:Set Value:Narration:$Narr
;	 
;
;      hjjajsgghagh:Walk Collection:CustExl2TlyJournalListColl2
;	  hjikskjsjsja:Log:$ccname1
;	10090	: 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10100	:	SET VALUE		: 	LedgerName			: 	$Ledname1
; 
;	10110	: 	SET VALUE		: 	Is Deemed Positive	:	yes
;	fgh1:Set Value:ISPARTYLEDGER:Yes
;	ahshghahgas:Set Value:ISLASTDEEMEDPOSITIVE:Yes
;	10111	:   Set Value		:   REMOVEZEROENTRIES	:   Yes
;	10105	: 	SET VALUE		: 	Amount				: 	 $$AsAmount:$Dramount1*-1
;    
;	j1:Insert Collection Object:BILLALLOCATIONS
;	
;	j3:Set Value:BILLTYPE:$btype
;	j2:Set Value:NAME:$ref
;	j4:Set Value:AMOUNT:$$AsAmount:$Dramount1*-1
;	
;    210080	: 	SET TARGET		: 	..
;	210081A	: 	SET TARGET		: 	..
;    hshaggaghag:End Walk
; 
;	10030 : 	INSERT COLLECTION OBJECT				: 	ALLLEDGERENTRIES
;	10040 :	SET VALUE		: 	LedgerName			: 	##BankName1receipt
;	 
;	10050	: 	SET VALUE		: 	Is Deemed Positive	: 	No
;	jkiuuhh:Set Value:ISPARTYLEDGER:Yes
;	shgsahaghsga:Set Value:ISLASTDEEMEDPOSITIVE:No
;	10045	: 	SET VALUE		: 	Amount				: 	$$AsAmount:$Dramount
;	
;       new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:Yes
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cc
;	new6:Set Value:Amount:$$AsAmount:$Dramount
;;    210080	: 	SET TARGET		: 	..
;;	210081A	: 	SET TARGET		: 	..
; new7:Set Target:..
; new8:Set Target:..
;
;   
;	jh1:Set Target:..
;	10115	: CREATE TARGET
;	shhds:End Walk
;	
;   
;
;
;[Button: SearchParty]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	Title   : $$LocaleString:"Search Party"
;	
;[Key: SearchPartyKey]
;	Key: Alt+S
;	Action: Alter: Ledger Name
;	
;[Button: SearchTrackName]
;	
;	Key: Alt+T
;	Action: Alter: Track NameTrigger
;	Title   : $$LocaleString:"One-Time Vendor"
;	
;	
;[Collection	:	TrackNameWise]
;	
;	Use         : TrackNameDetailsTable
;    Title       : $$LocaleString:"List of One-Time Vendor"
;	Belongs To	: Yes
;    Variable    : TrackName
;    Trigger     : Track NameTrigger
;	Fetch		: BMTrackName
;	Report      : BM Vehicle History
;
;
;[Report: Track NameTrigger]    ;;Auto Report
;        
;            Use     : Collection Variable
;            Local   : Line : Collection Variable : Field : Track NameTrigger
;            Local   : Field: MV Title            : Info  : $$LocaleString:"Name of One-Time Vendor"
;			
;[Field: Track NameTrigger]
;	
;	Use         : Name Field
;	Key         : Create Group
;	Set as      : if ##TrackName = "" then $$SysName:Primary else ##TrackName
;	Modifies    : TrackName
;	Table       : TrackNameWise
;	Show Table  : Always
;	CommonTable : No
;	
;
;[System	: Variables]
;	
;	TrackName	: ""
;	
;[Variable	: TrackName]
;	
;	Type	: String
;
;
;
;
;[Report: BM Vehicle History]
;	
;	Use		: DSP Template
;	Form	: BM Vehicle History
;	Variable	: LedgerName, TrackName		
;	On		: Load	: Yes	: Set	: LedgerName:$$SysName:AllItems
;    On		: Load	: Yes	: Set	: TrackName	:$$SysName:AllItems
;
;	[Form: BM Vehicle History]
;		
;		Use		: DSP Template
;		Part	: BM Vehicle HistoryTit, BM Vehicle History
;		Bottom Part	: BM Vehicle Total
;		Button		: SearchParty, SearchTrackName
;		
;		
;		[Part: BM Vehicle HistoryTit]
;			
;			Line	: BM Vehicle HistoryTit
;			
;			[Line: BM Vehicle HistoryTit]
;					
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: Default			: Type	: String
;				Local		: Field	: Default			: Align	: Centre
;				;;Local		: Field	: Default			: Delete: Border
;				Local		: Field	: BM His Date		: Setas	: "Date"
;				Local		: Field	: BM His Vch No		: Setas	: "Vch No"
;				Local		: Field	: BM PartyLedName	: Setas	: "Party Name"
;				Local		: Field	: BM His TrackName	: Setas	: "One-Time Vendor"
;				Local		: Field	: BM PanNo			: Setas	: "PAN"
;				Local		: Field	: BM His Rate		: Setas	: "Rate"
;				Local		: Field	: BM His CR_Amt		: Setas	: "Credit Amt"
;				Local		: Field	: BM His DR_Amt		: Setas	: "Debit Amt"
;				
;				Border		: Column Titles
;				
;				
;				
;	
;		[Part: BM Vehicle History]
;			
;			Line	: BM Vehicle History Rep
;			Repeat	: BM Vehicle History Rep	: Logic_Jrnl_Col
;			Scrolled	: Vertical
;			Common BOrder : Yes
;			Total	: BM His CR_Amt, BM His DR_Amt
;			
;			[Line: BM Vehicle History Rep]
;				
;				Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName, MastInv
;				Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt;, BM_VoucherId ;  DSP VchMasterID ;
;				Local		: Field	: Default	: Skip : Yes
;				Local		: Field	: Default	: Style	: Normal
;				
;				;Option  	: Alter On Enter	;: $$IsVoucher AND NOT $IsDeleted
;				Option		: AlterOnEnter
;				Key     	: VchrAlterOnEnter
;				
;				
;			[Field: MastInv]
;				
;				Use     : Name Field
;				Setas   : $$String:"ID:" + $$String:$MasterId
;				Invisible	: Yes
;				
;			[Key: VchrAlterOnEnter]
;
;				Key     : Enter
;				Action  : Alter : CurntVoucher
;
;			[Report: CurntVoucher]
;
;				Use     : Voucher
;				Form    : Voucher
;				Object  : Voucher : #MastInv
;
;
;				
;				[Field: BM His Date]
;					
;					Use		: UniDateField
;					Setas	: $Date
;					Alter	: Voucher
;					BOrder	: Thin Left
;					Width	: 12
;					Align	: Center
;					
;				[Field: BM His Vch No]
;					
;					Use		: Name Field
;					Setas	: $VoucherNumber
;					Border	: ThinLeft
;					Align	: Center
;				
;				[Field: BM PartyLedName]
;					
;					Use		: Name Field
;					Setas	: $LedgerName
;					Border	: ThinLeft
;					Full Width	: Yes
;					Align	: Center
;					
;				[Field: BM His TrackName]
;					
;					Use		: Name Field
;					Setas	: $TrackName
;					BOrder	: Thin Left
;					Align	: Center
;					
;				[Field: BM PanNo]
;					
;					Use		: Name Field
;					Setas	: $$ReportObject:$$CollectionFieldByKey:$OneTimePan1:#BMHisTrackName:TrackNameGather
;					BOrder	: ThinLeft
;					Width	: 15
;					Align	: Center
;
;				[Field: BM His Rate]
;					
;					Use		: Rate Price Field
;					Setas	: $Rate
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field: BM His CR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $CrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;	
;				[Field: BM His DR_Amt]
;					
;					Use		: Amount Field
;					Setas	: $DrAmount
;					Border	: ThinLeft
;					Width	: 15
;					Align	: Center
;					
;				[Field:	BM_VoucherId]
;					
;					Use		: Name Field
;					Set as	: "ID:" + $$String:$Masterid
;					Alter	: MyRep	;: $$Value
;					Modifies: VoucherMasterId	: Yes
;					
;					
;	[Report: MyRep]
;		
;		Use	: voucher
;		Object	: Voucher	: ##VoucherMasterId;("ID:" + $$String:$Masterid);#BM_VoucherId ;"ID:70393";
;			
;
;	[Part: BM Vehicle Total]
;		
;		Line	: BM Vehicle Total
;		
;		[Line: BM Vehicle Total]
;			
;			Field		: BM His Date, BM His Vch No, BM PartyLedName, BM His TrackName
;			Right Field	: BM PanNo, BM His CR_Amt, BM His DR_Amt
;				
;				Local		: Field	: Default	: Skip : Yes
;				
;				Local		: Field	: BM His Date		: Setas	: ""
;				Local		: Field	: BM His Vch No		: Setas	: ""
;				Local		: Field	: BM PartyLedName	: Setas	: ""
;				Local		: Field	: BM His TrackName	: Setas	: "Total"
;				Local		: Field	: BM His TrackName	: Align	: Right
;				Local		: Field	: BM PanNo			: Setas	: ""
;				Local		: Field	: BM His Rate		: Setas	: ""
;				Local		: Field	: BM His CR_Amt		: Setas	: $$Total:BMHisCR_Amt
;				Local		: Field	: BM His DR_Amt		: Setas	: $$Total:BMHisDR_Amt
;				
;				Border		: Column Titles
;
;			
;[Collection: Logic_Jrnl]
;	
;	Type		: Vouchers	: VoucherType
;	Child Of	: $$VchTypeJournal
;	Belongs To	: Yes
;	
;[Collection: Logic_Jrnl_Col]
;	
;	Source Collection	: Logic_Jrnl
;	Walk				: All Ledger Entries
;	Fetch				: LedgerName, TrackName, Amount
;	Compute				: VoucherNumber	: $..VoucherNumber
;	Compute				: Date			: $..Date
;	Compute				: CrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) then $Amount else $$AsAmount:0 
;	Compute				: DrAmount		: If ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors) then $Amount else $$AsAmount:0 
;	Compute				: Masterid		: $Masterid
;	Filter				: NonEmptyTrackName, SearchPartyFilter, SearchTrackName, OnlyDrCR
;	;Filter				: NonEmptyTrackName, OnlyDrCR
;
;;;select $VoucherNumber, $Date, $Masterid, $LedgerName, $TrackName, $Amount, $CrAmount, $DrAmount from Logic_Jrnl_Col
;
;
;[Collection: TrackNameGather]
;	
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate, TrackAddressAggregate
;	Fetch				: TrackAddress
;	Compute				: BMTrackName1			: $..BMTrackName
;	Compute				: OneTimePan1			: $..OneTimePan 
;	Compute				: BMPartyName1			: $..BMPartyName
;	Search Key			: $BMTrackName1
;	
;;;select $BMTrackName1, $BMPartyName1, $OneTimePan1, $TrackAddress from TrackNameGather
;
;[System: Formula]
;	
;		
;	;OnlyDrCR				: $$IsGroupSundryDebtors:($Parent:Ledger:$LedgerName) or $$IsGroupSundryCreditors:($Parent:Ledger:$LedgerName)
;	
;	OnlyDrCR				: ($$IsLedOfGrp:$LedgerName:$$GroupSundryCreditors) or ($$IsLedOfGrp:$LedgerName:$$GroupSundryDebtors)  
;	NonEmptyTrackName		: Not $$IsEmpty:$TrackName
;	SearchPartyFilter		: if ##LedgerName = $$SysName:AllItems then yes else $LedgerName=##LedgerName
;	SearchTrackName			: if ##TrackName = $$SysName:AllItems then yes else $TrackName=##TrackName
;
;
;
;	
;[Menu: BM Address Masters]
;	
;	Title       : @@locAddressMasters
;
;    Indent      : @@locAddressMasters
;   	Key Item    : BLANK
;	Key Item	: @@locAlter	       	: C : Alter    	  			    : AllTrackName
;	
;
;[Report: AllTrackName]
;	
;	Form	: AllTrackName
;	Object	: Company
;	
;	
;[Form: AllTrackName]
;	
;	Part	: FormSubtitle, AllTrackName
;	Local	: Part	: FormSubtitle	: Local: Line:	FormSubtitle: Local: Field: FormSubtitle	:  Info: $$LocaleString:"One-Time Vendor"
;	Height		: 80% Page
;	Width		: 40% Page
;	
;[Part: AllTrackName]
;	
;	Line	: AllTrackName
;	Repeat	: AllTrackName	: TrackNameAggregate
;	Scroll	: Vertical
;	Break On: $$IsEmpty:#AllTrackName
;	
;[Line: AllTrackName]
;	
;	Field	: AllTrackName
;	
;[Field: AllTrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Sub Form	: TrackName	: Not $$IsEmpty:$$Value
;	Full Width	: Yes
;  
;
;	
;;; Address in Cost Centre Master
;
;[Report: TrackName]
;	
;	Use		: Cost Centre
;	Delete	: Object
;	Add		: Object	: Aggregate
;	Delete	: Form
;	Add		: Form		: TrackName
;	Title	: $$LocaleString:"One-Time Vendor"
;	
;
;[Form: TrackName]
;
;	Use         : Master Accounting Form
;    Normal Color: @@SV_COSTCATEGORY   
;
;    Part        : TrackName
;	Local		: Line	: Default		: NoCursor	: Yes
;	Local		: Part	: Cost Centre	: delete	: Part       : CSTCTR Category, MST Basic, MST CostCentreParent
;	Height		: 50% Page
;	Width		: 40% Page
;	
;[Part: TrackName]
;    
;    Vertical   : Yes
;    ;Part       : BM TrackName, BM PartyName, BM PartyName Add, BM PartyName Tin
;	Part       : BM TrackName, BM PartyName Add, BM PartyName Pan
;
;[Part: BM TrackName]
;	
;	Line	: BM TrackName 
;	
;[Line: BM TrackName]
;	
;	Field	: Medium Prompt, BM TrackName
;	Local	: Field	: Medium Prompt : Setas :"One-Time Vendor :"
;	
;[Field: BM TrackName]
;	
;	Use			: Name Field
;	Storage		: BMTrackName
;	Width		: @@LongWidth
;	Set as		: #AllTrackName
;	Set Always	: Yes
;	
;
;	[Part: BM PartyName]
;		
;		Line	: BM PartyName 
;		
;		[Line: BM PartyName]
;			
;			Field	: Medium Prompt, BM PartyName
;			Local	: Field	: Medium Prompt : Setas :"Party Name:"
;			
;			[Field: BM PartyName]
;				
;				Use		: Name Field
;				Storage	: BMPartyName
;				Width	: @@LongWidth
;				
;	[Part: BM PartyName Add]
;		
;		Line		: BM PartyName Add
;		Repeat		: BM PartyName Add : TrackAddressAggregate
;		BreakOn		: $$IsEmpty:#BMPartyNameAdd;
;		Scroll		: Vertical
;		
;		[Line: BM PartyName Add]
;			
;			Field	: Medium Prompt, BM Party Name Add
;			Local	: Field	: Medium Prompt : Setas	: "Address:"
;			Local	: Field	: Medium Prompt	: Inactive	: $$Line >1
;			
;			[Field: BM PartyName Add]
;				
;				Use			: Name Field
;				Storage		: TrackAddress
;				Width		: @@LongWidth
;				
;[Part:BM PartyName Pan]
;	Line	: BM PartyName Pan
;	
;[Line: BM PartyName Pan]
;	Field	: Medium Prompt, BM PartyName Pan
;	Local	: Field : Medium Prompt : Info	: "PAN :"
;	
;[Field: BM PartyName Pan]
;	Use		: Name FIeld
;	Storage	: OneTimePan
;	Width	: @@LongWidth
;	
; 
;
;;;;;;;;;;;;;;;;;;; Journal Voucher Customization ;;;;;;;;;;;;;;;;;;;
;
;[#Line: VCHACC Column Title]
;
;	Add			: Option		: Logic_VCHACC Column Title		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Column Title]
;	   
;	Add: Right Fields: Before	:	VCH DebitTitle	:	DSP TrackNameTitle
;
;[Field: DSP TrackNameTitle]
;
;	Use			: Name Field
;    Setas       : $$LocaleString:"One-Time Vendor"
;    Style       : Normal Bold
;    Align       : Left
;    Skip        : Yes
;    Fixed       : Yes
;	
;[#Line: VCHACC Info]
;
;	Add			: Option		: Logic_VCHACC Info		: @@BSDCmpOnCustom And @@IsJournal
;	
;[!Line: Logic_VCHACC Info]
;	
;    Add			: Right Fields	: Before:  VCH DrAmt	:  VCHACC TrackName 
;		
;
;[Field: VCHACC TrackName]
;
;    Use		: Name field
;    Storage	: TrackName
;	Table	: TrackNameDetailsTable, EndOfList
;	;invisible: (#VchToBy = "To" or #VchToBy = "Cr")
;	
;
;[Collection: TrackNameTable]
;	
;	Type	: Company
;	Fetch	: BMTrackName, BMVehicleNumber, BMPartyName
;	
;[Collection: TrackNameDetailsTable]
;	
;	Title				: "One-Time Vendor"
;	Source Collection	: TrackNameTable
;	Walk				: TrackNameAggregate
;	Fetch				: BMTrackName, BMVehicleNumber, BMPartyName
;	Format				: $BMTrackName, 35
;
;
;;;select $BMTrackName, $BMVehicleNumber, $BMPartyName from TrackNameDetailsTable
;
;;[#Menu:gateway of tally]
;;	Add:Item:Journal Voucher:Alter:journal
;	 [Report:journal]
;		Form:jornal
;		Object:company
;		[Form:jornal]
;			Part				: jornal
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: purchaseread
;		
;
;		[Part	: jornal]
;			
;			Line	: jornal
;			
;
;[Line	: jornal]
;	
;		
;	
;
;		Line	:    aa, jornal1,jornal2,jornal3,jornal4,vchtypeline
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
; 
;[Line	: aa]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: jornal1]
;				Field		: Long Prompt,jornal1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: jornal2]
;				
;				Field	: Long Prompt,jornal2
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: jornal3]
;
;				Field	: Long Prompt,jornal3
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: jornal4]
;
;				Field	: Long Prompt,jornal4
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
;               [Line	: vchtypeline]
;				Field		: Long Prompt,vchtypeline
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Voucher Type"
; 
;
;[Field	: vchtypeline]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: vchtypeline
;	Modifies:vchtypeline:Yes
;	Table:list of voucher types
;	Show Table:Always
;	
;[Variable:vchtypeline]
;	Type:String
;	
;[System:Variables]
;	vchtypeline:""
;	
;[System:UDF]
;	vchtypeline:String:4606
;	
;
;
;[Field	: jornal1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: j1
;	
;
;[Field	: jornal2]
;	
;	Use			: Name Field 
;	Table		: journal
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
;	Storage		: j2
;
;[Table		: journal]
;	
;	Data Source	: Directory: #jornal1
;	Filter		: jour
;	Format		: $Name, 93
;	
;	
;[System	: Formulae]
;	
;	jour	: If ($Name Containing "~$") Then No Else ($Name ENDING WITH "csv" OR $Name ENDING WITH "xlsx" or $Name ENDING WITH "xlsx" or $Name ENDING WITH "xls")
;
;[Field	: jornal3]
;	
;	Use			: Name Field 
;	Set as		: #jornal1+ "\" +#jornal2
;	Set Always	: Yes
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j3
;	Case		: Normal
;	On			: Accept	: Yes	: Field Accept
;	On			: Accept	: Yes	: Call		: purchasesheet
;	
;
;[Function	: purchasesheet]
;	
;	Variable	: sss : Number
;	Variable	: Counter  : Number	: 1
;   
;	
;	00 : List Delete: jarr
;	10 : OPEN FILE  : #jornal3 : Excel : Read
;	20 : Set 		: sss : $$FileGetSheetCount
;	30 : While		: ##Counter <= ##sss
; 	40 : List Add Ex: jarr
;	50 : Set		: jarr[##Counter].Sheetname4:($$FileGetSheetName:##Counter)
;	60 : Increment	: Counter
;	70 : End While
;	80 : Refresh TDL	 
;
;
;	
;[Variable	: jarr]
;		
;	Variable: Sheetname4 : String
;	
;[System	: Variables]
;	
;	List Var : jarr
;	
;[Collection	: ddd]
;	
;	Title		: "Sheet Name"
;	Data Source	: Variable	: jarr
;	Format		: $Sheetname4
;	
;
;
;
;[Field	: jornal4]
;	
;	Use			: Name Field 
;	Table		:ddd
;	Show Table	: Always	
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Storage		: j4
;
;
;[System:UDF]
;j1:String:4500
;j2:String:5412
;j3:String:8998
;j4:String:9898
;
;
;
;
;
;[System:Variables]
;	listvariable:purchase
;	[Variable:purchase]
;	Variable:job:String
;	Variable:subledger:String
;	Variable:debit:String
;	Variable:creditamt1:String
;	Variable:narration:String
;	Variable:vchno:String
;	Variable:newvchdate:String
;	Variable:vchref:String
;	Variable:creditledger:String
;	Variable:vchreftype:String
;	
;
;
;
;
;[Function:purchaseread]
;Variable	: RowIndex			: Number	:	2
;	Variable	: ColIndex			: Number	
;	;Variable 	: IndexFromKeys 	: Number
;	Variable:varinded:Number:1
;	11: Open File : #jornal1+ "\" +#jornal2: Excel 	: Read
;12: Set Active Sheet: #jornal4
;13: List Delete : purchase
;14: While: Not $$IsEmpty:($$FileReadCell:##RowIndex:1)
;15:		List Add Ex	: purchase
;
;			
;a2:		Set			: purchase[##varinded].job: (($$FileReadCell:##RowIndex:5))        
;a7:     Set			:purchase[##varinded].subledger	: (($$FileReadCell:##RowIndex:6))				
;a8:		Set			:purchase[##varinded].debit: (($$FileReadCell:##RowIndex:8)) 
;a9:     Set			:purchase[##varinded].creditamt1	: (($$FileReadCell:##RowIndex:9))				       
;v3:		Set			:purchase[##varinded].narration: (($$FileReadCell:##RowIndex:10)) 
;v5:		Set			:purchase[##varinded].vchno: (($$FileReadCell:##RowIndex:1))
;v5NEW:		Set		:purchase[##varinded].newvchdate: (($$FileReadCell:##RowIndex:2))
;hjiu: Set:purchase[##varinded].creditledger: (($$FileReadCell:##RowIndex:7))
;hjuyt:Set:purchase[##varinded].vchref: (($$FileReadCell:##RowIndex:3))
;hjuytahhahah:Set:purchase[##varinded].vchreftype: (($$FileReadCell:##RowIndex:4))
;
;v6:Increment:RowIndex
;v7:Increment:varinded
;
;v12: End While
;v9: Close File
;
; 
;7567vbv: Msg Box : "Message" : "All Details Loaded, Press Enter"
;vcbdf:Call:journal import
;
;
;
;[Collection:purc]
;	Data Source:Variable:purchase
;		Fetch				: *.*
;		
;
;
;[Collection:test]
;	Source Collection:purc
;	By:vch1:$vchno
;	Compute:led:$subledger
;	Compute:narr:$narration
;	Compute:Nvcdate:$newvchdate
;	Compute:cc:$job
;	Compute:dr:$$Number:$debit
;	Compute:cr:$$Number:$creditamt1
;	Compute:ref:$vchref
;	Compute:cled:$creditledger
;	Compute:REFNAME:$vchreftype
;	
;	
;	;select $vch1,$led,$nvcdate,$cc,$dr,$cr from test
;;[Collection:test1]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,debitnew
;;[Collection:test2]
;;	Source Collection:purc
;;	Compute:vch1:$vchno
;;	Compute:led:$subledger
;;	Compute:dr:$$Number:$debit
;;	Compute:cr:$$Number:$creditamt1
;;	Compute:ccname:$job
;;	Filter:vouvherfilternew,creditnew
;;	;select $vch1,$led,$dr,$cr from test2
;[System:Formulae]
;	vouvherfilternew:$vch1=##numbnew
;debitnew:$$IsEmpty:$cr
;creditnew:$$IsEmpty:$dr
;
;
;
;
;
;[Function:journal import]
;	Variable:numbnew:String
;	Variable:cname:String
;	
;
;    important1:Start Batch Post:100
;	ldsggds:Log:"start"
;	;Batch0001: Start Batch Post    :100
;	0000IM	: START PROGRESS	: ($$NumItems:test)	:"Uploading":" Expense Vouchers"	
;		        	
;	 
;	q1:Walk Collection:test
;	q2:Set:numbnew:$vch1
;	hj1:Set:cname:$cc
;	q3:New Object:voucher
;	q4:Set Value:Date:$$Date:$Nvcdate
;	q5:Set Value:vouchernumber:##numbnew
;	hyu:Set Value:reference:$ref
;	q6:Set Value:VOUCHERTYPENAME:##vchtypeline
;	q7:Set Value:PERSISTEDVIEW:"Accounting Voucher View"
;	q8:Set Value:Narration:$narr
;	hjui98:Set Value:COSTCENTRENAME:##cname
;	
;   
;	
;	
;	a2:Insert Collection Object:ALLLEDGERENTRIES
;	a3:Set Value:LEDGERNAME:$led
;	
;	a4:Set Value:ISDEEMEDPOSITIVE:Yes
;	a6:Set Value:ISPARTYLEDGER:Yes
;	aaa:Set Value:ISLASTDEEMEDPOSITIVE:No
;	qwq:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    asda:Insert Collection Object:BILLALLOCATIONS
;	xx:Set Value:NAME:$ref
;	ssd:Set Value:BILLTYPE:$refname
;	asaqw:Set Value:AMOUNT:$$AsAmount:$dr*-1
;	
;    new1c:Insert Collection Object:CATEGORYALLOCATIONS
;	new2c:Set Value:CATEGORY:"Primary Cost Category"
;	new3c:Set Value:ISDEEMEDPOSITIVE:No
;	new4c:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5c:Set Value:NAME:##cname
;	new6c:Set Value:Amount:$$AsAmount:$dr*-1
;	
;	
;	wq:Set Target:..
;	asxa:Set Target:..
;	
;	f2:Insert Collection Object:ALLLEDGERENTRIES
;	
;	f33:Set Value:LEDGERNAME:$cled
;	f4:Set Value:ISDEEMEDPOSITIVE:No
;	f5:Set Value:ISPARTYLEDGER:Yes
;	f6:Set Value:AMOUNT:$$AsAmount:$cr
;	
;    asdas:Insert Collection Object:BILLALLOCATIONS
;	xxs:Set Value:NAME:$ref
;	ssds:Set Value:BILLTYPE:$refname
;	asaqws:Set Value:AMOUNT:$$AsAmount:$cr
;	
;	new1:Insert Collection Object:CATEGORYALLOCATIONS
;	new2:Set Value:CATEGORY:"Primary Cost Category"
;	new3:Set Value:ISDEEMEDPOSITIVE:No
;	new4:Insert Collection Object:COSTCENTREALLOCATIONS
;	new5:Set Value:NAME:##cname
;	new6:Set Value:Amount:$$AsAmount:$cr
;	
;     n1:Set Target:..
;	 n2:Set Target:..
;;	 lo1:Set Target:..
;;	 lo2:Set Target:..
;;	
;;	f7:Set Target:..
;;	f8:Set Target:..
;	
;	
;
;	
;	vcbvvbv:Create Target
;	dsds:End Walk
;	important4:End Progress
;	important2:End Batch Post
;	
; 
;	
;
;
;
;
;[Function:createledger]
;	Parameter:para1:String
;	Parameter:para2:String
;  
;	1322:New Object:Ledger
;	dad:Set Value:name:##para1
;	fgfvcx:If: not $$IsObjectExists:Group:##para2
;	nhu:Call:creategroup:##para2
;	etfdcvs:End If
;	fsd:Set Value:parent:$$String:##para2
;	new1:Set Target:..
;	new2:Save Target
;	
;[Function:creategroup]
;	Parameter:param:String
;	
;	terdf:New Object:Group
;	dfgcvx:Set Value:Name:##param
;	retvc:Set Value:Parent:"Direct Expenses"
;	fsfsffs:Set Target:..
;	tertvb:Save Target
;	
;
;
;[Report	: GSTUPLOAD4new1]
;	
;	Object	: Company
;	
;	[Form	: GSTUPLOAD4new1]
;		
;		Part				: GSTUPLOAD4new1
;		Vertical Align		: Top
;		Width				: 80% Screen
;		Background			: @@SV_RELEASEDLEAFGREEN_PL
;		
;		On					: Form Accept	: Yes	: Form Accept
;		On					: Form Accept   : Yes	: Call	: FnCustUdaan ExlSalesData14new1
;		
;
;		[Part	: GSTUPLOAD4new1]
;			
;			Line	: GSTUPLOAD4new1
;			
;
;[Line	: GSTUPLOAD4new1]
;	
;		
;	
;
;		Line	:    UploadTitle4new1, UploadExPath4new1,UploadFileName4new1,UploadFilePath4new1,UploadSheetName4new1,BankName1receipt,ExcelVhcTypeInfo4
;		Local	: Line	: Default : Space Bottom	: 0.35
;		
;  [Line	: BankName1receipt]
;				Field		: Long Prompt,BankName1receipt
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Bank Ledger:"
;[Field:BankName1receipt]
;	Use:name field
;	Storage:BankName1receipt
;	Modifies:BankName1receipt:Yes
;	Table:BankName1receipt
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	BankName1receipt:""
;	
;[Variable:BankName1receipt]
;	Type:String
;	
;
; [Line	: ExcelVhcTypeInfo4]
;				Field		: Long Prompt,ExcelVhcTypeInfo4
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Select Payment Voucher Type:"
;[Field:ExcelVhcTypeInfo4]
;	Use:name field
;	Storage:ExcelVhcTypeInfo4
;	Modifies:ExcelVhcTypeInfo4:Yes
;	Table:List of vouchertypes,end of list
;	Show Table:Always
;	Set Always:Yes
;	Border:thin box
;	Background:white
;	
;[System:Variables]
;	ExcelVhcTypeInfo4:""
;	
;[Variable:ExcelVhcTypeInfo4]
;	Type:String
;	
;
;
;[Collection:BankName1receipt]
;	Type:ledger
;	Format:$name,20
;		
;[Line	: UploadTitle4new1]
;				
;				Field	: Name Field
;				Local	: Field	: Name Field	: Info			: "Auto Journal Upload Creation"
;				Local	: Field	: Name Field	: Align			: Center
;				Local	: Field	: Name Field	: Color			: Red
;				Local	: Field	: Name Field	: Style			: Normal bold
;				Local	: Field	: Name Field	: Full Width	: Yes
;				Local	: Field	: Name Field	: Border		: Thin Bottom
;				
;     
;	         [Line	: UploadExPath4new1]
;				Field		: Long Prompt,UploadExPath4new1
;				Space Top	: 1
;				Local		: Field	: Long Prompt 	: Info	: "Excel Directory Path"
;				
;			[Line	: UploadFileName4new1]
;				
;				Field	: Long Prompt,UploadFileName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Excel File"
;				
;			[Line	: UploadFilePath4new1]
;
;				Field	: Long Prompt,UploadFilePath4new1
;				Local	: Field	: Long Prompt 		: Info	: "Excel File Path"
;				
;			[Line	: UploadSheetName4new1]
;
;				Field	: Long Prompt,UploadSheetName4new1
;				Local	: Field	: Long Prompt 		: Info	: "Select Sheet Name"
;				Border	: Thin Bottom
;				
;			
; 
; 
;
;[Field	: UploadExPath4new1]
;	
;	Use			: Name Field 
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Storage		: UploadExPath4new1
;	
;
;[Field	: UploadFileName4new1]
;	
;	Use			: Name Field 
;	Table		: File Name4new1
;	Border		: Thin Box
;	Align		: Left
;	Background	: White
;	Full Width	: Yes
;	Case		: Normal
;	Show Table	: Always
